SET(UCLSRC            src/ucl_util.c
                      src/ucl_parser.c
                      src/ucl_emitter.c
                      src/ucl_hash.c)

ADD_LIBRARY(rspamd-ucl ${LINK_TYPE} ${UCLSRC})
SET_TARGET_PROPERTIES(rspamd-ucl PROPERTIES VERSION ${RSPAMD_VERSION})
SET_TARGET_PROPERTIES(rspamd-ucl PROPERTIES COMPILE_FLAGS "-DRSPAMD_LIB")

TARGET_LINK_LIBRARIES(rspamd-ucl xxhash)
IF(HAVE_FETCH_H)
    TARGET_LINK_LIBRARIES(rspamd-ucl fetch)
ELSE(HAVE_FETCH_H)
    IF(CURL_FOUND)
        TARGET_LINK_LIBRARIES(rspamd-ucl ${CURL_LIBRARIES})
    ENDIF(CURL_FOUND)
ENDIF(HAVE_FETCH_H)
IF(OPENSSL_FOUND)
	TARGET_LINK_LIBRARIES(rspamd-ucl ${OPENSSL_LIBRARIES})
ENDIF(OPENSSL_FOUND)
TARGET_LINK_LIBRARIES(rspamd-ucl ${GLIB2_LIBRARIES})
IF(NO_SHARED MATCHES "OFF")
    INSTALL(TARGETS rspamd-ucl
        LIBRARY DESTINATION ${LIBDIR}
        PUBLIC_HEADER DESTINATION ${INCLUDEDIR})
ENDIF(NO_SHARED MATCHES "OFF")        